{"ast":null,"code":"import _regeneratorRuntime from\"/home/clickc/www/click-company-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/clickc/www/click-company-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/clickc/www/click-company-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/clickc/www/click-company-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useRef,useEffect}from'react';import{Link}from'react-router-dom';import{toast}from'react-toastify';import{useRecoilState,useSetRecoilState}from'recoil';import{selectedPlan,successfulBuy}from'../../recoil/atoms';var PaymentCard=function PaymentCard(_ref){var history=_ref.history;var plan=useRecoilState(selectedPlan);var setSuccessful=useSetRecoilState(successfulBuy);// const location = useLocation();\n// const [hiddenCupom, setHiddenCupom] = useState(false);\nvar _useState=useState(''),_useState2=_slicedToArray(_useState,2),numero=_useState2[0],setNumero=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),nome=_useState4[0],setNome=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),cvv=_useState6[0],setCvv=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),validade=_useState8[0],setValidade=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),mes=_useState10[0],setMes=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),ano=_useState12[0],setAno=_useState12[1];var erroDefault={\"number\":[],\"exp_month\":[],\"exp_year\":[],\"security_code\":[],\"name\":[],\"product_id\":[],\"error\":null};var _useState13=useState(erroDefault),_useState14=_slicedToArray(_useState13,2),erro=_useState14[0],setErro=_useState14[1];var numInput=useRef(null);var validateInput=useRef(null);var cvvImput=useRef(null);function handleEvent(e){var _e$target=e.target,value=_e$target.value,name=_e$target.name;switch(name){case'numero':setNumero(value);break;case'nome':setNome(value);break;case'cvv':setCvv(value);break;case'validade':setValidade(value);break;case'mes':setMes(value);break;case'ano':setAno(value);break;default:break;}}function validateMask(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var str=value.replace(/\\D/g,\"\").replace(/(\\d{2})/,\"$1/\").replace(/(\\d{2})\\/(\\d{1,3})/,\"$1/$2\").replace(/(\\d{2})\\/(\\d{4})+$/,\"$1/$2\");modifyREF(validateInput,str);}function validateCVV(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var str=value.replace(/\\D/g,\"\");modifyREF(cvvImput,str);}function modifyREF(ref,str){if((ref===null||ref===void 0?void 0:ref.current)!==null){console.log(ref.current.value,str);ref.current.value=str;}}function send(){return _send.apply(this,arguments);}function _send(){_send=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var body,Header,request,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setErro(function(value){return _objectSpread(_objectSpread({},value),erroDefault);});body={'number':numero,'exp_month':mes,'exp_year':ano,'security_code':cvv,'name':nome,'product_id':plan[0].idPlan};Header=new Headers();Header.append('Authorization','Bearer '.concat(localStorage.getItem('token')||''));Header.append('Content-Type','application/json');_context.next=7;return fetch('https://api.clickcompanyapp.com.br/api/payment/cartao',{method:'POST',headers:Header,body:JSON.stringify(body)});case 7:request=_context.sent;_context.next=10;return request.json();case 10:response=_context.sent;if(request.ok){setSuccessful(response.successful);setErro(_objectSpread({},erroDefault));history.push('/payment-approved');}else{setErro(function(value){return _objectSpread(_objectSpread({},value),response);});}case 12:case\"end\":return _context.stop();}}},_callee);}));return _send.apply(this,arguments);}useEffect(function(){if(erro.error!==null){toast.error(erro.error,{position:'bottom-right',autoClose:3000,hideProgressBar:true,closeOnClick:false,pauseOnHover:true,draggable:false,progress:undefined});}});return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cabecalho-register text-center\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Pagamento\",/*#__PURE__*/_jsx(Link,{to:'/packets',className:\"float-right\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-20px text-center my-6\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-color-FF4767 font-semibold font-size-17px\",children:\"Cart\\xE3o de cr\\xE9dito\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-20px my-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-size-17px text-color-413872 mb-6\",children:\"Preencha os dados do seu cart\\xE3o de cr\\xE9dito\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"body-register\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsx(\"input\",{name:'numero',type:'number',placeholder:'Número do cartão de crédito',value:numero,onChange:function onChange(e){handleEvent(e);},onKeyPress:function onKeyPress(e){handleEvent(e);},ref:numInput,size:16,className:'form-input'}),/*#__PURE__*/_jsx(\"span\",{className:\"ErrorLogin\",children:erro.number.map(function(e){return/*#__PURE__*/_jsx(\"li\",{children:e});})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{name:'nome',type:'text',placeholder:'Nome gravado no cartão',value:nome,onChange:function onChange(e){return handleEvent(e);},onKeyPress:function onKeyPress(e){return handleEvent(e);},className:'form-input'}),/*#__PURE__*/_jsx(\"span\",{className:\"ErrorLogin\",children:erro.name.map(function(e){return/*#__PURE__*/_jsx(\"li\",{children:e});})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{name:'mes',type:'text',placeholder:'Mês',value:mes,className:'form-input',onChange:function onChange(e){handleEvent(e);validateMask(e.target.value);},onKeyPress:function onKeyPress(e){handleEvent(e);validateMask(e.target.value);},maxLength:7}),/*#__PURE__*/_jsx(\"span\",{className:\"ErrorLogin\",children:erro.exp_month.map(function(e){return/*#__PURE__*/_jsx(\"li\",{children:e});})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{name:'ano',type:'text',placeholder:'Ano',value:ano,className:'form-input',onChange:function onChange(e){handleEvent(e);validateMask(e.target.value);},onKeyPress:function onKeyPress(e){handleEvent(e);validateMask(e.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"ErrorLogin\",children:erro.exp_year.map(function(e){return/*#__PURE__*/_jsx(\"li\",{children:e});})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{name:'cvv',type:'text',placeholder:'CVV',value:cvv,onChange:function onChange(e){handleEvent(e);validateCVV(e.target.value);},onKeyPress:function onKeyPress(e){handleEvent(e);validateCVV(e.target.value);},className:'form-input',maxLength:6,minLength:3,ref:cvvImput}),/*#__PURE__*/_jsx(\"span\",{className:\"ErrorLogin\",children:erro.security_code.map(function(e){return/*#__PURE__*/_jsx(\"li\",{children:e});})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"fixed left-0 bottom-0 w-full bg-gray-100 px-20px py-4\",role:\"button\",onClick:send,onKeyPress:send,tabIndex:0,children:/*#__PURE__*/_jsx(\"p\",{className:\"text-17px\",children:\"Pagar\"})})]})]});};export default PaymentCard;","map":{"version":3,"sources":["/home/clickc/www/click-company-main/src/pages/Payment/PaymentCard.tsx"],"names":["React","useState","useRef","useEffect","Link","toast","useRecoilState","useSetRecoilState","selectedPlan","successfulBuy","PaymentCard","history","plan","setSuccessful","numero","setNumero","nome","setNome","cvv","setCvv","validade","setValidade","mes","setMes","ano","setAno","erroDefault","erro","setErro","numInput","validateInput","cvvImput","handleEvent","e","target","value","name","validateMask","str","replace","modifyREF","validateCVV","ref","current","console","log","send","body","idPlan","Header","Headers","append","concat","localStorage","getItem","fetch","method","headers","JSON","stringify","request","json","response","ok","successful","push","error","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","number","map","exp_month","exp_year","security_code"],"mappings":"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","sourcesContent":["import React, {useState, useRef, useEffect} from 'react';\nimport { Link,RouteComponentProps } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { useRecoilState,useRecoilValue, useSetRecoilState } from 'recoil';\nimport { selectedPlan,successfulBuy } from '../../recoil/atoms';\n\nconst PaymentCard: React.FC<RouteComponentProps> = ({ history }) => {\n\tconst plan = useRecoilState(selectedPlan);\n\tconst setSuccessful = useSetRecoilState(successfulBuy);\n\n\t// const location = useLocation();\n\t// const [hiddenCupom, setHiddenCupom] = useState(false);\n\n\tconst [numero, setNumero] = useState('');\n\tconst [nome, setNome] = useState('');\n\tconst [cvv, setCvv] = useState('');\n\tconst [validade, setValidade] = useState('');\n\tconst [mes, setMes] = useState('');\n\tconst [ano, setAno] = useState('');\n\tconst erroDefault = {\n\t\t\"number\":[],\n\t\t\"exp_month\":[],\n\t\t\"exp_year\":[],\n\t\t\"security_code\":[],\n\t\t\"name\":[],\n\t\t\"product_id\": [],\n\t\t\"error\": null\n\t}\n\n\tconst [erro, setErro] = useState(erroDefault);\n\n\tconst numInput = useRef<HTMLInputElement>(null);\n\tconst validateInput = useRef<HTMLInputElement>(null);\n\tconst cvvImput = useRef<HTMLInputElement>(null);\n\n\tfunction handleEvent(e: any){\n\t\tconst { value, name } = e.target;\n\t\tswitch(name){\n\t\t\tcase 'numero':\n\t\t\t\tsetNumero(value);\n\t\t\t\tbreak;\n\t\t\tcase 'nome':\n\t\t\t\tsetNome(value);\n\t\t\t\tbreak;\n\t\t\tcase 'cvv':\n\t\t\t\tsetCvv(value);\n\t\t\t\tbreak;\n\t\t\tcase 'validade':\n\t\t\t\tsetValidade(value);\n\t\t\t\tbreak;\n\t\t\tcase 'mes':\n\t\t\t\tsetMes(value);\n\t\t\t\tbreak;\n\t\t\tcase 'ano':\n\t\t\t\tsetAno(value);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction validateMask(value: string = \"\"){\n\t\tconst str = value\n\t\t\t.replace(/\\D/g, \"\")\n\t\t\t.replace(/(\\d{2})/,\"$1/\")\n\t\t\t.replace(/(\\d{2})\\/(\\d{1,3})/,\"$1/$2\")\n\t\t\t.replace(/(\\d{2})\\/(\\d{4})+$/,\"$1/$2\");\n\n\t\tmodifyREF(validateInput,str)\n\t}\n\n\tfunction validateCVV(value: string = \"\"){\n\t\tconst str = value.replace(/\\D/g, \"\")\n\t\tmodifyREF(cvvImput,str)\n\t}\n\n\tfunction modifyREF(ref: React.RefObject<HTMLInputElement>  , str: string){\n\t\tif(ref?.current !== null){\n\t\t\tconsole.log(ref.current.value,str)\n\t\t\tref.current.value = str;\n\t\t}\n\t}\n\n\tasync function send(){\n\t\tsetErro(value => ({...value, ...erroDefault}));\n\n\t\tconst body = {\n\t\t\t'number': numero,\n\t\t\t'exp_month': mes,\n\t\t\t'exp_year': ano,\n\t\t\t'security_code': cvv,\n\t\t\t'name': nome,\n\t\t\t'product_id': plan[0].idPlan\n\t\t}\n\n\n\t\tconst Header = new Headers();\n\n\t\tHeader.append('Authorization', 'Bearer '.concat(localStorage.getItem('token') || ''));\n\t\tHeader.append('Content-Type','application/json');\n\n\t\tconst request = await fetch('https://api.clickcompanyapp.com.br/api/payment/cartao', \n\t\t\t{ \n\t\t\t\tmethod: 'POST', \n\t\t\t\theaders: Header,\n\t\t\t\tbody: JSON.stringify(body) \n\t\t\t}\n\t\t);\n\n\t\tconst response = await request.json();\n\n\t\tif(request.ok){\n\t\t\tsetSuccessful(response.successful)\n\t\t\tsetErro({...erroDefault});\n\t\t\thistory.push('/payment-approved')\n\t\t}else{\n\t\t\tsetErro( value => ({ ...value, ...response }) );\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\tif(erro.error !== null){\n\t\t\ttoast.error(erro.error, {\n\t\t\t\tposition: 'bottom-right',\n\t\t\t\tautoClose: 3000,\n\t\t\t\thideProgressBar: true,\n\t\t\t\tcloseOnClick: false,\n\t\t\t\tpauseOnHover: true,\n\t\t\t\tdraggable: false,\n\t\t\t\tprogress: undefined,\n\t\t\t});\n\t\t}\n\t})\n\n\treturn(\n\t\t<div className=\"bg-white\">\n\t\t\t<div className=\"cabecalho-register text-center\">\n\t\t\t\t<p>\n\t\t\t\t\tPagamento\n\t\t\t\t\t<Link to={'/packets'} className=\"float-right\">\n\t\t\t\t\t\t<i className=\"fas fa-times\" />\n\t\t\t\t\t</Link>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div className=\"px-20px text-center my-6\">\n\t\t\t\t<p className=\"text-color-FF4767 font-semibold font-size-17px\">\n\t\t\t\t\tCartão de crédito\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div className=\"px-20px my-6\">\n\t\t\t\t<p className=\"font-size-17px text-color-413872 mb-6\">\n\t\t\t\t\tPreencha os dados do seu cartão de crédito\n\t\t\t\t</p>\n\t\t\t\t<div className=\"body-register\">\n\t\t\t\t\t<div className=\"mt-8\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname={'numero'}\n\t\t\t\t\t\t\ttype={'number'}\n\t\t\t\t\t\t\tplaceholder={'Número do cartão de crédito'}\n\t\t\t\t\t\t\tvalue={numero}\n\t\t\t\t\t\t\tonChange={(e: any) => {handleEvent(e);}}\n\t\t\t\t\t\t\tonKeyPress={(e: any) => {handleEvent(e);}}\n\t\t\t\t\t\t\tref={numInput}\n\t\t\t\t\t\t\tsize={16}\n\t\t\t\t\t\t\tclassName={'form-input'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"ErrorLogin\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terro.number.map(\n\t\t\t\t\t\t\t\t\t(e) => (<li>{e}</li>)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname={'nome'}\n\t\t\t\t\t\t\ttype={'text'}\n\t\t\t\t\t\t\tplaceholder={'Nome gravado no cartão'}\n\t\t\t\t\t\t\tvalue={nome}\n\t\t\t\t\t\t\tonChange={(e: any) => handleEvent(e)}\n\t\t\t\t\t\t\tonKeyPress={(e: any) => handleEvent(e)}\n\t\t\t\t\t\t\tclassName={'form-input'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"ErrorLogin\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terro.name.map(\n\t\t\t\t\t\t\t\t\t(e) => (<li>{e}</li>)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname={'mes'}\n\t\t\t\t\t\t\ttype={'text'}\n\t\t\t\t\t\t\tplaceholder={'Mês'}\n\t\t\t\t\t\t\tvalue={mes}\n\t\t\t\t\t\t\tclassName={'form-input'}\n\t\t\t\t\t\t\tonChange={(e: any) => {\n\t\t\t\t\t\t\t\thandleEvent(e);\n\t\t\t\t\t\t\t\tvalidateMask(e.target.value);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonKeyPress={(e: any) => {\n\t\t\t\t\t\t\t\thandleEvent(e);\n\t\t\t\t\t\t\t\tvalidateMask(e.target.value);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tmaxLength={7}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"ErrorLogin\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terro.exp_month.map(\n\t\t\t\t\t\t\t\t\t(e) => (<li>{e}</li>)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname={'ano'}\n\t\t\t\t\t\t\ttype={'text'}\n\t\t\t\t\t\t\tplaceholder={'Ano'}\n\t\t\t\t\t\t\tvalue={ano}\n\t\t\t\t\t\t\tclassName={'form-input'}\n\t\t\t\t\t\t\tonChange={(e: any) => {\n\t\t\t\t\t\t\t\thandleEvent(e);\n\t\t\t\t\t\t\t\tvalidateMask(e.target.value);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonKeyPress={(e: any) => {\n\t\t\t\t\t\t\t\thandleEvent(e);\n\t\t\t\t\t\t\t\tvalidateMask(e.target.value);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"ErrorLogin\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terro.exp_year.map(\n\t\t\t\t\t\t\t\t\t(e) => (<li>{e}</li>)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname={'cvv'}\n\t\t\t\t\t\t\ttype={'text'}\n\t\t\t\t\t\t\tplaceholder={'CVV'}\n\t\t\t\t\t\t\tvalue={cvv}\n\t\t\t\t\t\t\tonChange={(e: any) => {\n\t\t\t\t\t\t\t\thandleEvent(e);\n\t\t\t\t\t\t\t\tvalidateCVV(e.target.value)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonKeyPress={(e: any) => {\n\t\t\t\t\t\t\t\thandleEvent(e);\n\t\t\t\t\t\t\t\tvalidateCVV(e.target.value)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclassName={'form-input'}\n\t\t\t\t\t\t\tmaxLength={6}\n\t\t\t\t\t\t\tminLength={3}\n\t\t\t\t\t\t\tref={cvvImput}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"ErrorLogin\">\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\terro.security_code.map(\n\t\t\t\t\t\t\t\t\t(e) => (<li>{e}</li>)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\n\t\t\t\t{/* <div className=\"footer-plano-escolhido fixed left-0 bottom-0 w-full px-20px py-3\">\n\t\t\t\t\t<p className=\"font-size-13px text-color-413872 font-semibold mb-2\">\n\t\t\t\t\t\t{plan[0].descriptionPlan}\n\t\t\t\t\t</p>\n\n\t\t\t\t\t<p className=\"font-size-13px text-color-575757 flex items-center w-full relative\">\n\t\t\t\t\t\t<span>Total do pedido</span>\n\t\t\t\t\t\t<span className=\"absolute right-0 text-color-413872 font-size-17px font-semibold\">\n\t\t\t\t\t\t\t{`R$ ${plan[0].pricePlan.toFixed(2).replace('.', ',')}`}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</p>\n\t\t\t\t</div> */}\n\t\t\t\t<div className=\"fixed left-0 bottom-0 w-full bg-gray-100 px-20px py-4\" role=\"button\" onClick={send} onKeyPress={send} tabIndex={0}>\n\t\t\t\t\t{/* <Link\n\t\t\t\t\t\tto={'/payment-approved-credit-card'}\n\t\t\t\t\t\tclassName=\"block w-full p-2 rounded-full text-center background-color-FF4767 text-white\"\n\t\t\t\t\t> */}\n\t\t\t\t\t<p className=\"text-17px\">Pagar</p>\n\t\t\t\t\t{/* </Link> */}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default PaymentCard;"]},"metadata":{},"sourceType":"module"}